SELECT

VENPROD.QTDE,
VENPROD.LUCROLIQUIDOOBTIDO AS LUCRO_PRODUTO,
VENPROD.MOVIMENTAESTOQUE,
VENPROD.tipovenda AS NORMAL,
VENPROD.PEDIDO,
VENPED.STATUS,
VENPED.GERAFINANCEIRO,


PAGFORN.CODIGO,
PAGFORN.NOME  FROM

TVENPRODUTO VENPROD
INNER JOIN
testfornecproduto ESTFORN
ON VENPROD.produto = ESTFORN.produto
INNER JOIN
tpagfornecedor PAGFORN
ON ESTFORN.fornecedor = PAGFORN.codigo
inner join tvenpedido VENPED
on VENPROD.pedido = VENPED.codigo
WHERE VENPROD.MOVIMENTAESTOQUE = 'S' AND VENPROD.tipovenda = 'N'
AND VENPED.status = 'EFE' AND VENPED.gerafinanceiro = 'S'

// This select extracts sales data by supplier
